<?php
 require_once(dirname(__FILE__) . '/browser.php'); require_once(dirname(__FILE__) . '/xml.php'); require_once(dirname(__FILE__) . '/test_case.php'); class RemoteTestCase { var $_url; var $_dry_url; var $_size; function RemoteTestCase($url, $dry_url = false) { $this->_url = $url; $this->_dry_url = $dry_url ? $dry_url : $url; $this->_size = false; } function getLabel() { return $this->_url; } function run(&$reporter) { $browser = &$this->_createBrowser(); $xml = $browser->get($this->_url); if (! $xml) { trigger_error('Cannot read remote test URL [' . $this->_url . ']'); return false; } $parser = &$this->_createParser($reporter); if (! $parser->parse($xml)) { trigger_error('Cannot parse incoming XML from [' . $this->_url . ']'); return false; } return true; } function &_createBrowser() { return new SimpleBrowser(); } function &_createParser(&$reporter) { return new SimpleTestXmlParser($reporter); } function getSize() { if ($this->_size === false) { $browser = &$this->_createBrowser(); $xml = $browser->get($this->_dry_url); if (! $xml) { trigger_error('Cannot read remote test URL [' . $this->_dry_url . ']'); return false; } $reporter = &new SimpleReporter(); $parser = &$this->_createParser($reporter); if (! $parser->parse($xml)) { trigger_error('Cannot parse incoming XML from [' . $this->_dry_url . ']'); return false; } $this->_size = $reporter->getTestCaseCount(); } return $this->_size; } } ?>